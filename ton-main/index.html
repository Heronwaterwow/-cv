<!DOCTYPE html>
<html>
<head>
<title>TON Connect with Console</title>
<script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
<style>
  #console {
    width: 500px;
    height: 200px;
    border: 1px solid #ccc;
    overflow-y: scroll;
    padding: 5px;
    font-family: monospace;
  }
</style>
</head>
<body>

<h1>TON Connect Example with Custom Console</h1>

<div id="ton-connect"></div>

<button onclick="connectCustom()">Connect with Custom Button</button>

<div id="console"></div>

<script>
  const manifestUrl = 'https://heronwaterwow.github.io/-cv/ton-main/tonconnect-manifest.json';
  const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
    manifestUrl: manifestUrl,
    buttonRootId: 'ton-connect'
  });

  const recipientAddress = 'UQA9or9rMdG8vk8wSX20LRapZgTUslxrHt-Oa4JCcAynwEEi';
  const amountToSend = 1000000; // 0.001 TON in nanotons

  const consoleDiv = document.getElementById('console');

  function logToConsole(message) {
    const newLine = document.createElement('div');
    newLine.textContent = message;
    consoleDiv.appendChild(newLine);
    consoleDiv.scrollTop = consoleDiv.scrollHeight; // Автоматическая прокрутка вниз
  }

  async function connectAndSend() {
    try {
      logToConsole("Connecting to wallet...");
      const connectedWallet = await tonConnectUI.connectWallet();
      logToConsole("Wallet connected:", connectedWallet);

      const tx = {
        validUntil: Date.now() + 5 * 60 * 1000,
        messages: [{
          address: recipientAddress,
          amount: amountToSend.toString()
        }]
      };
      logToConsole("Transaction object:", tx);

      logToConsole("Sending transaction...");
      const result = await tonConnectUI.sendTransaction(tx);
      logToConsole("Transaction successful! Hash:", result.hash);
      alert("Transaction sent successfully! Hash: " + result.hash);

    } catch (error) {
      logToConsole("Error Type:", typeof error);
      logToConsole("Error:", error);
      logToConsole("Error Stringified:", JSON.stringify(error));
      alert("Transaction failed. See console for details.");
    }
  }

  async function connectCustom() {
    connectAndSend();
  }
</script>

</body>
</html>


